!function(){"use strict";var t={};t.Router=class{routes=[];root="/";before;page404;constructor(t){t?.root&&(this.root="/"===t.root?"/":"/"+this.trimSlashes(t.root)+"/"),"function"==typeof t?.before&&(this.before=t.before),"function"==typeof t?.page404&&(this.page404=t.page404),t?.routes?.length>0&&t.routes.forEach((t=>{this.add(t.rule,t.handler,t.options)}))}get fragment(){let t=decodeURI(location.pathname);return"/"!==this.root&&(t=t.replace(this.root,"")),this.trimSlashes(t)}get query(){return this.parseQuery(location.search)}add(t,e,r){return this.routes.push({rule:this.parseRouteRule(t),handler:e,options:r}),this}remove(t){return"string"==typeof t&&(t=this.parseRouteRule(t)),this.routes.some(((e,r)=>(e.handler===t||e.rule===t)&&(this.routes.splice(r,1),!0))),this}async redirectTo(t,e){const r=this.transformURL(t);return history.replaceState(e,null,this.root+r),await this.processUri(),this}async navigateTo(t,e){const r=this.transformURL(t);return history.pushState(e,null,this.root+r),await this.processUri(),this}refresh(){return this.redirectTo(this.fragment+location.search,history.state)}transformURL(t){if("string"!=typeof t)return"";const e=t.trim().split("?");let r="",s="";return 1===e.length?r=e[0]:(r=e[0].trim(),s=e[1].trim()),r?("/"!==this.root&&(r=r.replace(this.root,"")),r=this.trimSlashes(r)):r=this.fragment,s?`${r}?${s}`:r}trimSlashes(t){return"string"!=typeof t?"":t.replace(/\/$/,"").replace(/^\//,"")}parseRouteRule(t){if("string"!=typeof t)return t;let e=this.trimSlashes(t).replace(/([\\\/\-\_\.])/g,"\\$1").replace(/\{[a-zA-Z]+\}/g,"(:any)").replace(/\:any/g,"[\\w\\-\\_\\.]+").replace(/\:word/g,"[a-zA-Z]+").replace(/\:num/g,"\\d+");return new RegExp("^"+e+"$","i")}parseQuery(t){let e={};return"string"!=typeof t||("?"===t[0]&&(t=t.substr(1)),t.split("&").forEach((t=>{let r=t.split("=");""!==r[0]&&(void 0===r[1]&&(r[1]=!0),e[decodeURIComponent(r[0])]=r[1])}))),e}async findRoute(){let t=this.fragment,e=!1;for(let r of this.routes){let s=t.match(r.rule);if(s){s.shift();let o={fragment:t,query:this.query,match:s,options:r.options},i=this.before?.(o);i||await(r.handler?.(o)),e=!0;break}}return e}async processUri(){let t=this.fragment;await this.findRoute()||this.page404?.(t)}addUriListener(){window.onpopstate=this.processUri.bind(this)}removeUriListener(){window.onpopstate=null}};const{Router:e}=t;let r=new e({routes:[{rule:"",handler(t){console.log(t)}},{rule:"hello/(:any)",handler(t){console.log(t)}},{rule:"category/(:num)/post/(:num)",handler(t){console.log(t)}},{rule:"search",handler(t){console.log(t)}}]});window.router=r}();
//# sourceMappingURL=router-1.1.1.js.map
